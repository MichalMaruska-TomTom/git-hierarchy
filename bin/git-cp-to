#!/bin/bash -eu

source /usr/share/git-hierarchy/functions.sh
GIT_DIR=$(git_dir)


commit=$1
branch=$2

# resolve before checkout. if HEAD, it must be the original.
commit=$(git rev-parse $commit)


# current branch?
head=$(dump_ref_without_ref HEAD)
head=${head##refs/heads/}

git checkout $branch
git cherry-pick $commit

# this migth be in TRAP
# and avoid the warning on detached.
# so just echo > .git/HEAD ?
git checkout $head
