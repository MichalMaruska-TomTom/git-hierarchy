#! /usr/bin/zsh -feu

source /usr/share/git-hierarchy/functions.sh
GIT_DIR=$(git_dir)


# fixme: not a ref. a BRANCH!

# rebasing this ref, upon its base.
# The base is somehow defined ...
ref=$1
branch=${ref#refs/heads/}

cmd=
# cmd=echo

if is_sum $branch; then
    # sum? ->
    # shouldn't it be  EVALed?
    $cmd git-sum-branches -r $branch
elif is_segment $branch; then
# segment ->
    $cmd git-rebase-segment $branch
else
    echo "unknown -- leaving unchanged $ref"
fi
